@import "tailwindcss/preflight";
@tailwind utilities;

/* Simple, Tailwind v4-compatible global stylesheet with blue theme tokens */
:root {
  --foreground-rgb: 0, 0, 0;
  --background-start-rgb: 214, 219, 220;
  --background-end-rgb: 255, 255, 255;

  /* color tokens (H S% L%) stored as three numbers for hsl(var(--...)) */
  --background: 220 100% 5%;
  --foreground: 220 20% 90%;
  --card: 220 100% 7%;
  --card-foreground: 220 20% 90%;
  --popover: 220 100% 7%;
  --popover-foreground: 220 20% 90%;
  --primary: 220 90% 56%;
  --primary-foreground: 220 20% 98%;
  --secondary: 220 60% 20%;
  --secondary-foreground: 220 20% 90%;
  --muted: 220 30% 15%;
  --muted-foreground: 220 10% 60%;
  --accent: 220 90% 56%;
  --accent-foreground: 220 20% 98%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 220 20% 20%;
  --input: 220 20% 20%;
  --ring: 220 90% 56%;
  --chart-1: 220 90% 56%;
  --chart-2: 220 60% 40%;
  --chart-3: 220 40% 30%;
  --chart-4: 220 80% 70%;
  --chart-5: 220 70% 60%;
  --radius: 0.5rem;
  --sidebar-background: 220 100% 7%;
  --sidebar-foreground: 220 20% 90%;
  --sidebar-primary: 220 90% 56%;
  --sidebar-primary-foreground: 220 20% 98%;
  --sidebar-accent: 220 90% 56%;
  --sidebar-accent-foreground: 220 20% 98%;
  --sidebar-border: 220 20% 20%;
  --sidebar-ring: 220 90% 56%;
}

@media (prefers-color-scheme: dark) {
  :root {
    --foreground-rgb: 255, 255, 255;
    --background-start-rgb: 0, 0, 0;
    --background-end-rgb: 0, 0, 0;
  }
}

/* Basic base styles using CSS variables so Tailwind doesn't need custom utilities */
html {
  height: 100%;
}

body {
  position: relative;
  min-height: 100vh;
  background: linear-gradient(
    135deg,
    #0f172a 0%,
    #1e3a8a 25%,
    #1e40af 50%,
    #0369a1 75%,
    #0c4a6e 100%
  );
  background-attachment: fixed;
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
  color: #f8fafc;
  font-family:
    "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue",
    Arial;
}

/* set default border color */
*,
*::before,
*::after {
  border-color: hsl(var(--border));
}

/* Skeleton helpers */
.skeleton * {
  pointer-events: none !important;
}
.skeleton *[class^="text-"] {
  color: transparent;
  background-color: rgba(var(--foreground-rgb), 0.2);
  border-radius: 0.375rem; /* rounded-md */
  -webkit-animation: pulse 1.5s ease-in-out infinite;
  animation: pulse 1.5s ease-in-out infinite;
}
.skeleton-bg {
  background-color: rgba(var(--foreground-rgb), 0.1);
}
.skeleton-div {
  background-color: rgba(var(--foreground-rgb), 0.2);
  -webkit-animation: pulse 1.5s infinite;
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
  100% {
    opacity: 1;
  }
}

@keyframes gradientShift {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* CodeMirror area */
.cm-editor,
.cm-gutters {
  background-color: hsl(var(--background));
}
.cm-activeLine {
  background: transparent;
}

/* Suggestion highlight uses standard Tailwind utilities — keep as-is */
.suggestion-highlight {
  /* keep the original intent; Tailwind utilities will expand at build-time */
}

/* minimal scrollbar styling */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background: hsl(var(--border));
  border-radius: 3px;
  transition: background 0.2s ease;
}
::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.6);
}
::-webkit-scrollbar-corner {
  background: transparent;
}

/* firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--border)) transparent;
}
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --foreground-rgb: 229, 231, 235;
  /* off-white text */
  --background-start-rgb: 0, 0, 0;
  --background-end-rgb: 0, 0, 0;
}

@media (prefers-color-scheme: dark) {
  :root {
    --foreground-rgb: 229, 231, 235;
    --background-start-rgb: 0, 0, 0;
    --background-end-rgb: 0, 0, 0;
  }
}

@layer base {
  :root {
    --background: 220 100% 5%;
    /* almost black */
    --foreground: 220 20% 90%;
    /* off-white */
    --card: 220 100% 7%;
    /* dark card */
    --card-foreground: 220 20% 90%;
    --popover: 220 100% 7%;
    --popover-foreground: 220 20% 90%;
    --primary: 220 90% 56%;
    /* blue */
    --primary-foreground: 220 20% 98%;
    --secondary: 220 60% 20%;
    /* dark blue */
    --secondary-foreground: 220 20% 90%;
    --muted: 220 30% 15%;
    --muted-foreground: 220 10% 60%;
    --accent: 220 90% 56%;
    /* blue accent */
    --accent-foreground: 220 20% 98%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 220 20% 20%;
    --input: 220 20% 20%;
    --ring: 220 90% 56%;
    --chart-1: 220 90% 56%;
    --chart-2: 220 60% 40%;
    --chart-3: 220 40% 30%;
    --chart-4: 220 80% 70%;
    --chart-5: 220 70% 60%;
    --radius: 0.5rem;
    --sidebar-background: 220 100% 7%;
    --sidebar-foreground: 220 20% 90%;
    --sidebar-primary: 220 90% 56%;
    --sidebar-primary-foreground: 220 20% 98%;
    --sidebar-accent: 220 90% 56%;
    --sidebar-accent-foreground: 220 20% 98%;
    --sidebar-border: 220 20% 20%;
    --sidebar-ring: 220 90% 56%;
  }

  .dark {
    --background: 220 100% 5%;
    --foreground: 220 20% 90%;
    --card: 220 100% 7%;
    --card-foreground: 220 20% 90%;
    --popover: 220 100% 7%;
    --popover-foreground: 220 20% 90%;
    --primary: 220 90% 56%;
    --primary-foreground: 220 20% 98%;
    --secondary: 220 60% 20%;
    --secondary-foreground: 220 20% 90%;
    --muted: 220 30% 15%;
    --muted-foreground: 220 10% 60%;
    --accent: 220 90% 56%;
    --accent-foreground: 220 20% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 220 20% 20%;
    --input: 220 20% 20%;
    --ring: 220 90% 56%;
    --chart-1: 220 90% 56%;
    --chart-2: 220 60% 40%;
    --chart-3: 220 40% 30%;
    --chart-4: 220 80% 70%;
    --chart-5: 220 70% 60%;
    --sidebar-background: 220 100% 7%;
    --sidebar-foreground: 220 20% 90%;
    --sidebar-primary: 220 90% 56%;
    --sidebar-primary-foreground: 220 20% 98%;
    --sidebar-accent: 220 90% 56%;
    --sidebar-accent-foreground: 220 20% 98%;
    --sidebar-border: 220 20% 20%;
    --sidebar-ring: 220 90% 56%;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* base rules using direct CSS where custom utilities would otherwise be required */
@layer base {
  /* set default border color from theme */
  * {
    border-color: hsl(var(--border));
  }

  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    font-family:
      "Fira Mono", "JetBrains Mono", "Roboto Mono", "Menlo", "Consolas",
      "Liberation Mono", monospace;
  }
}

.skeleton {
  * {
    pointer-events: none !important;
  }

  *[class^="text-"] {
    color: transparent;
    @apply rounded-md select-none animate-pulse;
    background-color: rgba(var(--foreground-rgb), 0.2);
  }

  .skeleton-bg {
    background-color: rgba(var(--foreground-rgb), 0.1);
  }

  .skeleton-div {
    @apply animate-pulse;
    background-color: rgba(var(--foreground-rgb), 0.2);
  }
}

.ProseMirror {
  outline: none;
}

.cm-editor,
.cm-gutters {
  background-color: hsl(var(--background));
  @apply dark:bg-zinc-800 outline-hidden selection:bg-zinc-900;
}

.ͼo.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground,
.ͼo.cm-selectionBackground,
.ͼo.cm-content::selection {
  @apply bg-zinc-200 dark:bg-zinc-900;
}

.cm-activeLine,
.cm-activeLineGutter {
  @apply bg-transparent;
}

.cm-activeLine {
  @apply rounded-r-sm;
}

.cm-lineNumbers {
  @apply min-w-7;
}

.cm-foldGutter {
  @apply min-w-3;
}

.cm-lineNumbers .cm-activeLineGutter {
  @apply rounded-l-sm;
}

.suggestion-highlight {
  @apply bg-blue-200 hover:bg-blue-300 dark:hover:bg-blue-400/50 dark:text-blue-50 dark:bg-blue-500/40;
}

/* minimal scrollbar styling */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--border));
  border-radius: 3px;
  transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(var(--muted-foreground), 0.5);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--border)) transparent;
}

@theme inline {
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    border-color: hsl(var(--border));
    outline-color: hsl(var(--ring));
  }

  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
}
@import "tailwindcss";

/* include utility classes in streamdown */
@source '../node_modules/streamdown/dist/index.js';

/* Add KaTeX CSS for math rendering */
@import "katex/dist/katex.min.css";

/* custom variant for setting dark mode programmatically */
@custom-variant dark (&:is(.dark, .dark *));

/* include plugins */
@plugin "tailwindcss-animate";
@plugin "@tailwindcss/typography";

/* define design tokens (light mode) */
:root {
  --background: 0 0% 100%;
  --foreground: 240 10% 3.9%;
  --card: 0 0% 100%;
  --card-foreground: 240 10% 3.9%;
  --popover: 0 0% 100%;
  --popover-foreground: 240 10% 3.9%;
  --primary: 240 5.9% 10%;
  --primary-foreground: 0 0% 98%;
  --secondary: 240 4.8% 95.9%;
  --secondary-foreground: 240 5.9% 10%;
  --muted: 240 4.8% 95.9%;
  --muted-foreground: 240 3.8% 46.1%;
  --accent: 240 4.8% 95.9%;
  --accent-foreground: 240 5.9% 10%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 240 5.9% 90%;
  --input: 240 5.9% 90%;
  --ring: 240 10% 3.9%;
  --chart-1: 12 76% 61%;
  --chart-2: 173 58% 39%;
  --chart-3: 197 37% 24%;
  --chart-4: 43 74% 66%;
  --chart-5: 27 87% 67%;
  --sidebar-background: 0 0% 98%;
  --sidebar-foreground: 240 5.3% 26.1%;
  --sidebar-primary: 240 5.9% 10%;
  --sidebar-primary-foreground: 0 0% 98%;
  --sidebar-accent: 240 4.8% 95.9%;
  --sidebar-accent-foreground: 240 5.9% 10%;
  --sidebar-border: 220 13% 91%;
  --sidebar-ring: 217.2 91.2% 59.8%;
  /* border radius unit */
  --radius: 0.5rem;
  --sidebar: hsl(0 0% 98%);
}

/* define design tokens (dark mode) */
.dark {
  --background: 240 10% 3.9%;
  --foreground: 0 0% 98%;
  --card: 240 10% 3.9%;
  --card-foreground: 0 0% 98%;
  --popover: 240 10% 3.9%;
  --popover-foreground: 0 0% 98%;
  --primary: 0 0% 98%;
  --primary-foreground: 240 5.9% 10%;
  --secondary: 240 3.7% 15.9%;
  --secondary-foreground: 0 0% 98%;
  --muted: 240 3.7% 15.9%;
  --muted-foreground: 240 5% 64.9%;
  --accent: 240 3.7% 15.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --border: 240 3.7% 15.9%;
  --input: 240 3.7% 15.9%;
  --ring: 240 4.9% 83.9%;
  --chart-1: 220 70% 50%;
  --chart-2: 160 60% 45%;
  --chart-3: 30 80% 55%;
  --chart-4: 280 65% 60%;
  --chart-5: 340 75% 55%;
  --sidebar-background: 240 5.9% 10%;
  --sidebar-foreground: 240 4.8% 95.9%;
  --sidebar-primary: 224.3 76.3% 48%;
  --sidebar-primary-foreground: 0 0% 100%;
  --sidebar-accent: 240 3.7% 15.9%;
  --sidebar-accent-foreground: 240 4.8% 95.9%;
  --sidebar-border: 240 3.7% 15.9%;
  --sidebar-ring: 217.2 91.2% 59.8%;
  --sidebar: hsl(240 5.9% 10%);
}

/* define theme */
@theme {
  --font-sans: var(--font-geist);
  --font-mono: var(--font-geist-mono);

  --breakpoint-toast-mobile: 600px;

  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  --color-sidebar: var(--sidebar-background);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

@utility text-balance {
  text-wrap: balance;
}

@utility -webkit-overflow-scrolling-touch {
  -webkit-overflow-scrolling: touch;
}

@utility touch-pan-y {
  touch-action: pan-y;
}

@utility overscroll-behavior-contain {
  overscroll-behavior: contain;
}

@layer utilities {
  :root {
    --foreground-rgb: 0, 0, 0;
    --background-start-rgb: 214, 219, 220;
    --background-end-rgb: 255, 255, 255;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --foreground-rgb: 255, 255, 255;
      --background-start-rgb: 0, 0, 0;
      --background-end-rgb: 0, 0, 0;
    }
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    overflow-x: hidden;
    position: relative;
  }

  html {
    overflow-x: hidden;
  }
}

.skeleton {
  * {
    pointer-events: none !important;
  }

  *[class^="text-"] {
    color: transparent;
    @apply rounded-md bg-foreground/20 select-none animate-pulse;
  }

  .skeleton-bg {
    @apply bg-foreground/10;
  }

  .skeleton-div {
    @apply bg-foreground/20 animate-pulse;
  }
}

.ProseMirror {
  outline: none;
}

.cm-editor,
/* Accessibility fallback: ensure readable foreground/background when vars collide */
  :root {
  /* fallback H S% L% values (used if --foreground or --background are missing or produce poor contrast) */
  --_fallback-foreground: 220 20% 10%; /* dark gray */
  --_fallback-background: 0 0% 100%; /* white */
}

/* Final override to ensure readable text contrast — placed at end to override earlier rules */
html,
body {
  color: hsl(var(--foreground, var(--_fallback-foreground)));
  background-color: hsl(var(--background, var(--_fallback-background)));
}

.ͼo.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground,
.ͼo.cm-selectionBackground,
.ͼo.cm-content::selection {
  @apply bg-zinc-200 dark:bg-zinc-900;
}

.cm-activeLine,
.cm-activeLineGutter {
  @apply bg-transparent;
}

.cm-activeLine {
  @apply rounded-r-sm;
}

.cm-lineNumbers {
  @apply min-w-7;
}

.cm-foldGutter {
  @apply min-w-3;
}

.cm-lineNumbers .cm-activeLineGutter {
  @apply rounded-l-sm;
}

.suggestion-highlight {
  @apply bg-blue-200 hover:bg-blue-300 dark:hover:bg-blue-400/50 dark:text-blue-50 dark:bg-blue-500/40;
}

/* minimal scrollbar styling */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
  transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: --alpha(var(--muted-foreground) / 0.5);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

@theme inline {
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}
